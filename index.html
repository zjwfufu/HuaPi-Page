<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Bringing Your Portrait to 3D Presence">
    <meta name="keywords" content="3D Avatar, Human Reconstruction, Computer Vision, Graphics">
    <!-- Open Graph tags for social media -->
    <meta property="og:title" content="ComGS">
    <meta property="og:description" content="">
    <meta property="og:image" content="">
    
    <title>Bringing Your Portrait to 3D Presence</title>
    
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="css/dics.min.css">
    <link rel="stylesheet" href="css/teaser-examples.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <script src="scripts/dics.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', domReady);
        function domReady() {
            for (const e of document.querySelectorAll(".b-dics")) {
                new Dics({
                    container: e,
                    textPosition: "top"
                });
            }
        }
    </script>
    <link rel="shortcut icon" href="img/icon.ico" type="image/x-icon" />
    
    <style>
        :root {
            --primary-color: #3273dc;
            --primary-color-rgb: 50, 115, 220;
            --secondary-color: #363636;
            --accent-color: #0a5eb2;
            --light-bg: #f5f5f5;
            --section-padding: 3rem 0;
            --border-radius: 5px;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            color: #333;
            line-height: 1.6;
            padding-top: 0px; /* Space for fixed navbar */
        }
        
        .navbar {
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            background-color: white;
        }
        
        .navbar-brand {
            font-weight: 700;
        }
        
        .navbar-light .navbar-nav .nav-link {
            color: var(--secondary-color);
            font-weight: 500;
            padding: 0.5rem 1rem;
            transition: color 0.3s;
        }
        
        .navbar-light .navbar-nav .nav-link:hover {
            color: var(--primary-color);
        }
        
        .hero-section {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 4rem 0;
            border-radius: 0 0 var(--border-radius) var(--border-radius);
        }
        
        section {
            padding: var(--section-padding);
        }
        
        h1, h2, h3, h4, h5 {
            font-weight: 700;
            color: var(--secondary-color);
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            transition: all 0.3s;
        }
        
        .btn-primary:hover {
            background-color: var(--accent-color);
            border-color: var(--accent-color);
            transform: translateY(-2px);
        }
        
        .card {
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.15);
        }
        
        .text-justify {
            text-align: justify;
        }
        
        .author-links a {
            color: var(--secondary-color);
            transition: color 0.3s;
        }
        
        .author-links a:hover {
            color: var(--primary-color);
            text-decoration: none;
        }
        
        /* Custom video player styles */
        .video-container {
            margin-bottom: 2rem;
        }
        
        .video-controls {
            background-color: rgba(255,255,255,0.9);
            padding: 0.75rem;
            border-radius: var(--border-radius);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }
        
        /* Back to top button */
        .back-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--primary-color);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            z-index: 1000;
        }
        
        .back-to-top.visible {
            opacity: 1;
        }
        
        .back-to-top:hover {
            transform: translateY(-3px);
        }
        
        /* Loading indicator for videos */
        .video-wrapper {
            position: relative;
        }
        
        .loading-spinner {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }
        
        /* Section dividers */
        .section-divider {
            height: 2px;
            background: linear-gradient(to right, transparent, var(--primary-color), transparent);
            margin: 2rem 0;
        }
        
        /* Footer buttons styling */
        .footer-btn {
            display: inline-flex;
            padding: 10px 20px;
            border-radius: 8px;
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            text-decoration: none;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.15);
            font-size: 16px;
            font-weight: 500;
        }
        
        .footer-btn:hover {
            background-color: var(--primary-color);
            color: white;
            text-decoration: none;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .footer-btn .icon-container {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.15);
        }
        
        .footer-btn:hover .icon-container {
            background-color: rgba(255, 255, 255, 0.3);
        }
        
        /* Custom range input styling */
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 5px;
            background: #ddd;
            outline: none;
            border-radius: 5px;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 15px;
            height: 15px;
            background: var(--primary-color);
            cursor: pointer;
            border-radius: 50%;
        }
        
        input[type="range"]::-moz-range-thumb {
            width: 15px;
            height: 15px;
            background: var(--primary-color);
            cursor: pointer;
            border-radius: 50%;
            border: none;
        }
        
        /* Video loading improvements */
        .video-wrapper {
            position: relative;
        }
        
        .video-wrapper video {
            opacity: 0;
            transition: opacity 0.5s;
        }
        
        .video-wrapper video.loaded {
            opacity: 1;
        }
        
        .comparison-video {
            transition: transform 0.3s ease;
        }
        
        .comparison-video:hover {
            transform: scale(1.02);
        }
        
        /* Material Editing Controls */
        .material-controls .btn {
            border-radius: 4px;
            margin: 0 2px;
            font-size: 0.85rem;
            padding: 0.375rem 0.5rem;
            transition: all 0.2s ease;
        }
        
        .material-controls .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .material-controls .btn.active {
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .material-icon {
            display: inline-block;
            width: 16px;
            text-align: center;
        }
        
        @media (max-width: 767.98px) {
            .material-controls .btn {
                padding: 0.25rem;
                font-size: 0.75rem;
            }
            
            .material-controls .material-icon {
                margin-right: 0 !important;
            }
            
            .material-controls .btn span.material-icon + span {
                display: none; /* Hide text on mobile, show only icons */
            }
        }
        
        .composition-video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .composition-video.active {
            opacity: 1;
            visibility: visible;
        }

        .composition-video-container {
            position: relative;
            width: 100%;
            height: 0;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
        }
        
        .teaser-comp-video {
            width: 100%;
            height: auto;
            display: block;
        }
    </style>
</head>

<body>
    <!-- Navigation Bar
    <nav class="navbar navbar-expand-lg navbar-light fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#">ComGS</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#abstract">Abstract</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#method">Method</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#comparison">Comparison</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#syncom">SynCom</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#phone-captured">Phone-Captured</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav> -->

    <!-- Hero Section -->
    <section class="hero-section" id="home">
        <div class="container">
            <div class="row">
                <div class="col-12 text-center">
                    <h1 class="mb-4">Bringing Your Portrait to 3D Presence</h1>
                    <div class="author-links" style="max-width: 70%; margin: 0 auto; text-align: center;">
                        <h5 class="mb-3"> 
                            <a href="https://zjwsite.github.io/" target="_blank">Jiawei Zhang</a><sup>1</sup>,
                            <a href="https://lei65537.github.io/" target="_blank">Lei Chu</a><sup>2</sup>,
                            <a href="https://www.microsoft.com/en-us/research/people/jiahali/" target="_blank">Jiahao Li</a><sup>2</sup>,
                            <a href="https://openreview.net/profile?id=%7EZhenyu_Zang1" target="_blank">Zhenyu Zang</a><sup>2</sup>,
                            <a href="https://openreview.net/profile?id=~Chong_Li11" target="_blank">Chong Li</a><sup>2</sup>,
                            <br>
                            <a href="https://pableeto.github.io/" target="_blank">Xiao Li</a><sup>2</sup>,
                            <a href="https://cite.nju.edu.cn/" target="_blank">Xun Cao</a><sup>1</sup>,
                            <a href="http://zhuhao.cc/" target="_blank">Hao Zhu</a><sup>1</sup>,
                            <a href="https://scholar.google.com/citations?user=djk5l-4AAAAJ&hl=zh-CN" target="_blank">Yan Lu</a><sup>2</sup>,
                        </h5>
                        <h6 class="mb-0">
                            <sup>1</sup>Nanjing University, <sup>2</sup>Microsoft Research Asia
                        </h6>
                    </div>
                    
                </div>
            </div>

            <div class="text-center mt-4">
                <a href="" class="btn btn-dark mx-2" target="_blank" style="background-color: #343a40; border-color: #343a40;">
                    <i class="fas fa-file-pdf mr-2"></i>Paper
                </a>
                <a href="" class="btn btn-dark mx-2" target="_blank" style="background-color: #343a40; border-color: #343a40;">
                    <i class="fab fa-github mr-2"></i>Code
                </a>
                <!-- <a href="" class="btn btn-dark mx-2" target="_blank" style="background-color: #343a40; border-color: #343a40;">
                    <i class="fas fa-database mr-2"></i>Dataset
                </a> -->
            </div>
        </div>
    </section>

     <!-- Combined Introduction & Videos Section -->
     <section class="py-3">
        <div class="container">
            <div class="row">
                <div class="col-12 mb-4">
                    <div class="card shadow-sm">
                        <div class="card-body bg-light">
                            <div class="text-center mb-3">
                                <img src="img/teaser.jpg"
                                    alt="Teaser of our method"
                                    class="img-fluid rounded"
                                    style="max-width: 100%; height: auto;">
                            </div>
                            <div class="d-flex align-items-center">
                                <div class="mr-3" style="min-width: 60px;">
                                    <span style="font-weight: 600; color: var(--primary-color); font-size: 0.95rem;">
                                        TL;DR
                                    </span>
                                </div>
                                <p class="mb-0" style="line-height: 1.6;">
                                    We present a <strong>unified framework</strong> capable of reconstructing animatable 3D avatars from a
                                    single portrait, supporting head, half-body, and full-body inputs.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Abstract Section -->
    <section id="abstract" class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="text-center">
                        <h2>Abstract</h2>
                        <div class="section-divider my-3"></div>
                    </div>
                    
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <!-- Introduction -->
                            <div class="abstract-section mb-4">
                                <div class="content-box">
                                    <p class="text-justify">We present a unified framework for reconstructing animatable 3D human avatars from a single portrait across head, half-body, and full-body inputs. Our method tackles three bottlenecks: pose- and framing-sensitive feature representations, limited scalable data, and unreliable proxy-mesh estimation. We introduce a <strong>Dual-UV representation</strong> that maps image features to a canonical UV space via Core-UV and Shell-UV branches, eliminating pose- and framing-induced token shifts. We also build a <strong>factorized synthetic data manifold</strong> combining 2D generative diversity with geometry-consistent 3D renderings, supported by a training scheme that improves realism and identity consistency. A <strong>robust proxy-mesh tracker</strong> maintains stability under partial visibility. Together, these components enable strong in-the-wild generalization. Trained only on half-body synthetic data, our model achieves state-of-the-art head and upper-body reconstruction and competitive full-body results. Extensive experiments and analyses further validate the effectiveness of our approach.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Method Overview Section -->
    <section id="method" class="py-5 bg-light">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="text-center mb-4">
                        <h2>Method Overview</h2>
                        <div class="section-divider my-3"></div>
                    </div>
                    
                    <div class="pipeline-container">
                        <div class="card shadow-sm mb-0 border-0">
                            <div class="card-body p-0">
                                <img src="img/method.jpg" alt="Pipeline Diagram" class="img-fluid w-100">
                            </div>
                        </div>
                        
                        <div class="method-overview-content bg-white shadow-sm rounded-bottom pt-4 px-4">
                            <!-- <h4 class="mb-3"><span class="text-primary">Realistic 3D Object-Scene Composition Pipeline</span></h4> -->
                            <p class="method-text">
                                We address three key bottlenecks: reconstruction representation for 3D avatar, insufficient data, and unstable mesh estimation.
                            </p>
                                
                                <div class="row method-steps mt-4">
                                    <div class="col-md-4 d-flex">
                                        <div class="step-card">
                                            <div class="step-number">1</div>
                                            <h5>Reconstruction Representation</h5>
                                            <p class="text-justify">We propose a Dual-UV representation for reconstructing 3D human avatars, mapping image features to canonical UV space.</p>
                                        </div>
                                    </div>
                                    <div class="col-md-4 d-flex">
                                        <div class="step-card">
                                            <div class="step-number">2</div>
                                            <h5>Data Generation</h5>
                                            <p class="text-justify">We build a hybrid dataset by combining geometry-anchored 3D rendering with semantics-driven generative synthesis.</p>
                                        </div>
                                    </div>
                                    <div class="col-md-4 d-flex">
                                        <div class="step-card">
                                            <div class="step-number">3</div>
                                            <h5>Mesh Estimation</h5>
                                            <p class="text-justify">We develop a robust mesh tracker that combines multiple estimators to produce consistent estimation.</p>
                                        </div>
                                    </div>
                                </div>

                                
                                <div id="method-drawer-toggle" class="text-center mt-4">
                                    <button class="btn btn-outline-primary">
                                        <i class="fas fa-caret-down mr-1"></i> See Tracking Process Details
                                    </button>
                                </div>
                                
                                <div id="method-drawer" class="method-drawer">
                                    <div class="card shadow-sm mt-3">
                                        <div class="card-body">
                                            <!-- <h4 class="text-primary mb-3">Inverse Rendering with Surface Octahedral Probes (SOPs).</h4> -->
                                            <img src="img/tracker.jpg" alt="Reconstruction Process" class="img-fluid">

                                            <p class="text-justify">
                                                We illustrate our proxy-mesh estimation pipeline using a single image for clarity, while noting
                                                that the pipeline naturally supports parallel processing for multi-frame inputs. Starting from an input image, we preprocess it to extract a
                                                foreground mask and apply a pretrained human mesh recovery model to obtain an initial mesh estimate. The initial estimate is subsequently
                                                refined through body, head, and hand refinement.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <style>
                        .pipeline-container {
                            max-width: 100%;
                            margin-bottom: 3rem;
                        }
                        .method-overview-content {
                            margin-top: -1px;
                        }
                        .method-text {
                            font-size: 1.1rem;
                            line-height: 1.7;
                        }
                        .method-drawer {
                            max-height: 0;
                            overflow: hidden;
                            transition: all 0.5s ease-out;
                            opacity: 0;
                        }
                        .method-drawer.open {
                            max-height: 800px; /* Adjust based on your image size */
                            opacity: 1;
                            transition: all 0.5s ease-in;
                        }
                        .method-steps .step-card {
                            background-color: white;
                            border-radius: 8px;
                            padding: 1.5rem;
                            height: 100%;
                            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
                            transition: all 0.3s ease;
                            position: relative;
                            border-top: 3px solid var(--primary-color);
                        }
                        .method-steps .step-card:hover {
                            transform: translateY(-5px);
                            box-shadow: 0 5px 15px rgba(var(--primary-color-rgb), 0.15);
                        }
                        #method-drawer-toggle {
                            margin-bottom: 15px;
                        }
                        #method-drawer-toggle button {
                            transition: all 0.3s ease;
                        }
                        #method-drawer-toggle button.active {
                            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
                        }
                        .step-number {
                            position: absolute;
                            top: -15px;
                            left: 20px;
                            width: 30px;
                            height: 30px;
                            background-color: var(--primary-color);
                            color: white;
                            border-radius: 50%;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            font-weight: bold;
                        }
                    </style>
                    
                </div>
            </div>
        </div>
    </section>

    <!-- Comparison Section -->
    <section id="comparison" class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="text-center mb-4">
                        <h2>Self Reenactment</h2>
                        <div class="section-divider my-3"></div>
                    </div>
                </div>
            </div>
            
            <!-- Scene Selection Buttons -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="text-center">
                        <div class="btn-group btn-group-lg" role="group" aria-label="Scene Selection">
                            <button type="button" class="btn btn-primary active" id="scene-bottle">
                                Upper-Body
                            </button>
                            <button type="button" class="btn btn-secondary" id="scene-kettle">
                                Head-Portrait
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="video-container" class="mt-4">
                <div class="row justify-content-center">
                    <div class="col-12">
                        <div class="card h-100 video-wrapper">
                            <div class="loading-spinner">
                                <div class="spinner-border text-primary" role="status"></div>
                            </div>
                            <video width="100%" playsinline muted preload class="comparison-video" id="final-comparison-video">
                                <source src="img/videos/self_reenact/upper_body/self-reenact_x264.mp4" type="video/mp4" 
                                        data-bottle="img/videos/self_reenact/upper_body/self-reenact_x264.mp4"
                                        data-kettle="img/videos/self_reenact/head_portrait/self-reenact-head_x264.mp4">
                            </video>
                            <div id="progress-container" style="width: 100%; height: 5px; background-color: #eee; margin-top: 10px;">
                                <!-- <div id="progress-bar" style="width: 0; height: 100%; background-color: #007bff;"></div> -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <script>
                var video = document.getElementById('final-comparison-video');
                var progressBar = document.getElementById('progress-bar');

                video.addEventListener('timeupdate', function() {
                    var percentage = (video.currentTime / video.duration) * 100;
                    progressBar.style.width = percentage + '%';
                });
            </script>
            
            

            <div class="row mt-4">
                <div class="col-12">
                    <div class="video-controls text-center">
                        <div class="d-flex align-items-center justify-content-center">
                            <button id="play-pause-btn" class="btn btn-primary">
                                <i class="fas fa-play mr-1"></i> Play
                            </button>
                            <div class="mx-3 flex-grow-1" style="max-width: 70%;">
                                <input type="range" id="video-progress" class="form-control-range" min="0" max="100" value="0" step="0.1">
                            </div>
                            <span id="time-display" class="text-monospace">0:00 / 0:00</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Novel View Synthesis Section -->
    <section id="novel-view" class="py-5 bg-light">
        <div class="container">
            <!-- 标题 -->
            <div class="row">
                <div class="col-12">
                    <div class="text-center mb-4">
                        <h2>Novel View Synthesis</h2>
                        <div class="section-divider my-3"></div>
                    </div>
                </div>
            </div>

            <!-- 视角选择按钮 -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="text-center">
                        <div class="btn-group btn-group-lg" role="group" aria-label="Novel View Selection">
                            <button type="button"
                                    class="btn btn-primary active novel-view-btn"
                                    data-src="img/videos/novel_view/novel_view_synthesis_head_x264.mp4">
                                Head-Portrait
                            </button>
                            <button type="button"
                                    class="btn btn-secondary novel-view-btn"
                                    data-src="img/videos/novel_view/novel_view_synthesis_upper_x264.mp4">
                                Upper-Body
                            </button>
                            <button type="button"
                                    class="btn btn-secondary novel-view-btn"
                                    data-src="img/videos/novel_view/novel_view_synthesis_body_x264.mp4">
                                Full-Body
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 视频区域 -->
            <div id="novel-video-container" class="mt-4">
                <div class="row justify-content-center">
                    <div class="col-12">
                        <div class="card h-100 video-wrapper">
                            <div class="loading-spinner">
                                <div class="spinner-border text-primary" role="status"></div>
                            </div>
                            <video width="100%" playsinline muted preload
                                class="comparison-video" id="novel-video">
                                <!-- 默认显示 Head-Portrait -->
                                <source src="img/videos/novel_view/novel_view_synthesis_head_x264.mp4"
                                        type="video/mp4">
                            </video>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 控制条 -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="video-controls text-center">
                        <div class="d-flex align-items-center justify-content-center">
                            <button id="novel-play-pause-btn" class="btn btn-primary">
                                <i class="fas fa-play mr-1"></i> Play
                            </button>
                            <div class="mx-3 flex-grow-1" style="max-width: 70%;">
                                <input type="range" id="novel-video-progress" class="form-control-range"
                                    min="0" max="100" value="0" step="0.1">
                            </div>
                            <span id="novel-time-display" class="text-monospace">0:00 / 0:00</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
    document.addEventListener('DOMContentLoaded', function () {
        var novelVideo         = document.getElementById('novel-video');
        var novelPlayPauseBtn  = document.getElementById('novel-play-pause-btn');
        var novelVideoProgress = document.getElementById('novel-video-progress');
        var novelTimeDisplay   = document.getElementById('novel-time-display');
        var novelViewButtons   = document.querySelectorAll('.novel-view-btn');

        function formatTime(seconds) {
            seconds = Math.floor(seconds || 0);
            var m = Math.floor(seconds / 60);
            var s = seconds % 60;
            return m + ':' + (s < 10 ? '0' + s : s);
        }

        function updateTimeDisplay() {
            var current = novelVideo.currentTime || 0;
            var total   = novelVideo.duration || 0;
            novelTimeDisplay.textContent = formatTime(current) + ' / ' + formatTime(total);
        }

        // 更新时间和滑条
        novelVideo.addEventListener('timeupdate', function () {
            if (novelVideo.duration) {
                var percentage = (novelVideo.currentTime / novelVideo.duration) * 100;
                novelVideoProgress.value = percentage;
            } else {
                novelVideoProgress.value = 0;
            }
            updateTimeDisplay();
        });

        // 拖动进度条
        novelVideoProgress.addEventListener('input', function () {
            if (!novelVideo.duration) return;
            var newTime = (novelVideoProgress.value / 100) * novelVideo.duration;
            novelVideo.currentTime = newTime;
        });

        // 播放 / 暂停
        novelPlayPauseBtn.addEventListener('click', function () {
            if (novelVideo.paused) {
                novelVideo.play();
                novelPlayPauseBtn.innerHTML = '<i class="fas fa-pause mr-1"></i> Pause';
            } else {
                novelVideo.pause();
                novelPlayPauseBtn.innerHTML = '<i class="fas fa-play mr-1"></i> Play';
            }
        });

        // 切换视角
        novelViewButtons.forEach(function (btn) {
            btn.addEventListener('click', function () {
                // 切按钮样式
                novelViewButtons.forEach(function (b) {
                    b.classList.remove('btn-primary', 'active');
                    b.classList.add('btn-secondary');
                });
                this.classList.remove('btn-secondary');
                this.classList.add('btn-primary', 'active');

                // 切视频 src
                var newSrc = this.getAttribute('data-src');
                if (newSrc) {
                    novelVideo.pause();
                    var sourceTag = novelVideo.querySelector('source');
                    sourceTag.src = newSrc;
                    novelVideo.load();
                    novelVideoProgress.value = 0;
                    novelTimeDisplay.textContent = '0:00 / 0:00';
                    // 自动播放新视频
                    novelVideo.play();
                    novelPlayPauseBtn.innerHTML = '<i class="fas fa-pause mr-1"></i> Pause';
                }
            });
        });

        // metadata 加载后初始化时间显示
        novelVideo.addEventListener('loadedmetadata', updateTimeDisplay);
    });
    </script>


    <!-- Cross Reenactment Section -->
    <section id="cross-reenactment" class="py-5">
        <div class="container">
            <!-- 标题 -->
            <div class="row">
                <div class="col-12">
                    <div class="text-center mb-4">
                        <h2>Cross Reenactment</h2>
                        <div class="section-divider my-3"></div>
                    </div>
                </div>
            </div>
            
            <!-- seq 选择按钮 -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="text-center">
                        <div class="btn-group btn-group-lg" role="group" aria-label="Cross Reenactment Sequences">
                            <button type="button" class="btn btn-primary active cross-seq-btn"
                                    data-src="./img/videos/cross_reenact/cross_reenact_4_x264.mp4">
                                seq-1
                            </button>
                            <button type="button" class="btn btn-secondary cross-seq-btn"
                                    data-src="./img/videos/cross_reenact/cross_reenact_2_x264.mp4">
                                seq-2
                            </button>
                            <button type="button" class="btn btn-secondary cross-seq-btn"
                                    data-src="./img/videos/cross_reenact/cross_reenact_3_x264.mp4">
                                seq-3
                            </button>
                            <button type="button" class="btn btn-secondary cross-seq-btn"
                                    data-src="./img/videos/cross_reenact/cross_reenact_1_x264.mp4">
                                seq-4
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 视频 + 外层卡片 -->
            <div id="cross-video-container" class="mt-4">
                <div class="row justify-content-center">
                    <div class="col-12">
                        <div class="card h-100 video-wrapper">
                            <div class="loading-spinner">
                                <div class="spinner-border text-primary" role="status"></div>
                            </div>
                            <video width="100%" playsinline muted preload 
                                class="comparison-video" id="cross-video">
                                <!-- 默认展示 seq-1 -->
                                <source src="./img/videos/cross_reenact/cross_reenact_4_x264.mp4" type="video/mp4">
                            </video>
                            <!-- 这里不再加第二个进度条，避免和下面的 slider 重复 -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- 播放控制 / 进度条 -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="video-controls text-center">
                        <div class="d-flex align-items-center justify-content-center">
                            <button id="cross-play-pause-btn" class="btn btn-primary">
                                <i class="fas fa-play mr-1"></i> Play
                            </button>
                            <div class="mx-3 flex-grow-1" style="max-width: 70%;">
                                <input type="range" id="cross-video-progress" class="form-control-range" 
                                    min="0" max="100" value="0" step="0.1">
                            </div>
                            <span id="cross-time-display" class="text-monospace">0:00 / 0:00</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
    document.addEventListener('DOMContentLoaded', function () {
        var crossVideo          = document.getElementById('cross-video');
        var crossPlayPauseBtn   = document.getElementById('cross-play-pause-btn');
        var crossVideoProgress  = document.getElementById('cross-video-progress');
        var crossTimeDisplay    = document.getElementById('cross-time-display');
        var seqButtons          = document.querySelectorAll('.cross-seq-btn');

        function formatTime(seconds) {
            seconds = Math.floor(seconds || 0);
            var m = Math.floor(seconds / 60);
            var s = seconds % 60;
            return m + ':' + (s < 10 ? '0' + s : s);
        }

        function updateTimeDisplay() {
            var current = crossVideo.currentTime || 0;
            var total   = crossVideo.duration || 0;
            crossTimeDisplay.textContent = formatTime(current) + ' / ' + formatTime(total);
        }

        // 更新进度条 & 时间显示
        crossVideo.addEventListener('timeupdate', function () {
            if (crossVideo.duration) {
                var percentage = (crossVideo.currentTime / crossVideo.duration) * 100;
                crossVideoProgress.value = percentage;
            } else {
                crossVideoProgress.value = 0;
            }
            updateTimeDisplay();
        });

        // 拖动进度条 seek
        crossVideoProgress.addEventListener('input', function () {
            if (!crossVideo.duration) return;
            var newTime = (crossVideoProgress.value / 100) * crossVideo.duration;
            crossVideo.currentTime = newTime;
        });

        // 播放 / 暂停
        crossPlayPauseBtn.addEventListener('click', function () {
            if (crossVideo.paused) {
                crossVideo.play();
                crossPlayPauseBtn.innerHTML = '<i class="fas fa-pause mr-1"></i> Pause';
            } else {
                crossVideo.pause();
                crossPlayPauseBtn.innerHTML = '<i class="fas fa-play mr-1"></i> Play';
            }
        });

        // 切换 seq
        seqButtons.forEach(function (btn) {
            btn.addEventListener('click', function () {
                // 切按钮样式
                seqButtons.forEach(function (b) {
                    b.classList.remove('btn-primary', 'active');
                    b.classList.add('btn-secondary');
                });
                this.classList.remove('btn-secondary');
                this.classList.add('btn-primary', 'active');

                // 切视频 src
                var newSrc = this.getAttribute('data-src');
                if (newSrc) {
                    crossVideo.pause();
                    var sourceTag = crossVideo.querySelector('source');
                    sourceTag.src = newSrc;
                    crossVideo.load();
                    crossVideoProgress.value = 0;
                    crossTimeDisplay.textContent = '0:00 / 0:00';
                    // 自动播放新视频
                    crossVideo.play();
                    crossPlayPauseBtn.innerHTML = '<i class="fas fa-pause mr-1"></i> Pause';
                }
            });
        });

        // 初始时间显示
        crossVideo.addEventListener('loadedmetadata', updateTimeDisplay);
    });
    </script>



    
    <!-- Back to top button -->
    <a href="#" class="back-to-top" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </a>

    <!-- jQuery and Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" crossorigin="anonymous"></script>
    
    <!-- Custom Video Control Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            'use strict';
            
            // Method Section Drawer Animation
            const drawerToggle = document.getElementById('method-drawer-toggle');
            const methodDrawer = document.getElementById('method-drawer');
            
            if (drawerToggle && methodDrawer) {
                const toggleButton = drawerToggle.querySelector('button');
                
                // Preload the image
                let preloadImage = new Image();
                preloadImage.src = "img/tracker.jpg";
                
                // Toggle drawer on button click
                toggleButton.addEventListener('click', function(e) {
                    if (methodDrawer.classList.contains('open')) {
                        methodDrawer.classList.remove('open');
                        toggleButton.classList.remove('active');
                        toggleButton.innerHTML = '<i class="fas fa-caret-down mr-1"></i> See Tracking Process Details';
                    } else {
                        methodDrawer.classList.add('open');
                        toggleButton.classList.add('active');
                        toggleButton.innerHTML = '<i class="fas fa-caret-up mr-1"></i> Hide Tracking Details';
                    }
                });
            }
            
            // DOM Elements
            const video = document.querySelector('.comparison-video');
            const teaserVideos = document.querySelectorAll('.card-img-top');
            const progressBar = document.getElementById('video-progress');
            const playPauseBtn = document.getElementById('play-pause-btn');
            const timeDisplay = document.getElementById('time-display');
            const bottleBtn = document.getElementById('scene-bottle');
            const kettleBtn = document.getElementById('scene-kettle');
            const backToTopBtn = document.getElementById('backToTop');
            
            // State variables
            let isPlaying = false;
            let currentScene = 'bottle'; // Default scene
            let isVideoReady = false;
            
            // Utility functions
            const formatTime = (timeInSeconds) => {
                const minutes = Math.floor(timeInSeconds / 60);
                const seconds = Math.floor(timeInSeconds % 60).toString().padStart(2, '0');
                return `${minutes}:${seconds}`;
            };
            
            // Loading management
            const handleVideoLoading = (videoElement) => {
                const wrapper = videoElement.closest('.video-wrapper');
                if (!wrapper) return;
                
                const spinner = wrapper.querySelector('.loading-spinner');
                if (!spinner) return;

                const hideSpinner = () => {
                    spinner.style.display = 'none';
                    videoElement.classList.add('loaded');
                    isVideoReady = true;
                    initializeControls();
                };

                // Hide spinner immediately if video is already loaded
                if (videoElement.readyState >= 4) { // HAVE_ENOUGH_DATA
                    hideSpinner();
                } else {
                    // Add event listeners for loading states
                    ['loadeddata', 'canplaythrough', 'playing'].forEach(event => {
                        videoElement.addEventListener(event, hideSpinner, { once: true });
                    });
                    
                    // Fallback timeout
                    setTimeout(hideSpinner, 2000);
                }
            };

            // Initialize loading handling for all videos
            document.querySelectorAll('video').forEach(handleVideoLoading);
            
            // Initialize video loading listeners
            if (video) {
                // Check if video is already loaded
                if (video.readyState >= 2) { // HAVE_CURRENT_DATA or better
                    isVideoReady = true;
                    initializeControls();
                }
                
                // Listen for video load events
                video.addEventListener('loadeddata', function() {
                    isVideoReady = true;
                    initializeControls();
                });
                
                // Prevent autoplay
                video.pause();
            }
            
            // Scene switching
            const updateSceneButtons = (scene) => {
                if (scene === 'bottle') {
                    bottleBtn.classList.add('active', 'btn-primary');
                    bottleBtn.classList.remove('btn-secondary');
                    
                    kettleBtn.classList.remove('active', 'btn-primary');
                    kettleBtn.classList.add('btn-secondary');
                } else {
                    kettleBtn.classList.add('active', 'btn-primary');
                    kettleBtn.classList.remove('btn-secondary');
                    
                    bottleBtn.classList.remove('active', 'btn-primary');
                    bottleBtn.classList.add('btn-secondary');
                }
            };
            
            const changeScene = (scene) => {
                currentScene = scene;
                
                // Stop video if playing
                if (isPlaying && video) {
                    video.pause();
                    playPauseBtn.innerHTML = '<i class="fas fa-play mr-1"></i> Play';
                    isPlaying = false;
                }
                
                // Reset progress
                progressBar.value = 0;
                
                // Update video source and reload
                if (video) {
                    const source = video.querySelector('source');
                    const newSrc = source.getAttribute(`data-${scene}`);
                    source.setAttribute('src', newSrc);
                    video.load();
                    
                    // Wait for video to load
                    video.addEventListener('loadeddata', function() {
                        initializeControls();
                    }, { once: true });
                }
            };
            
            // Scene button event listeners
            bottleBtn.addEventListener('click', () => {
                if (currentScene !== 'bottle') {
                    changeScene('bottle');
                    updateSceneButtons('bottle');
                }
            });
            
            kettleBtn.addEventListener('click', () => {
                if (currentScene !== 'kettle') {
                    changeScene('kettle');
                    updateSceneButtons('kettle');
                }
            });
            
            // Video play/pause handler
            const handlePlayPause = (event) => {
                // If clicked on video while playing, just pause
                if (event && event.target && event.target.tagName === 'VIDEO' && isPlaying) {
                    video.pause();
                    playPauseBtn.innerHTML = '<i class="fas fa-play mr-1"></i> Play';
                    isPlaying = false;
                    return;
                }
                
                if (isPlaying) {
                    // Pause video
                    video.pause();
                    playPauseBtn.innerHTML = '<i class="fas fa-play mr-1"></i> Play';
                } else {
                    // Play video if ready
                    if (video && video.readyState >= 2) {
                        const playPromise = video.play();
                        if (playPromise !== undefined) {
                            playPromise.then(() => {
                                playPauseBtn.innerHTML = '<i class="fas fa-pause mr-1"></i> Pause';
                            }).catch(error => {
                                console.log('Autoplay prevented:', error);
                                playPauseBtn.innerHTML = '<i class="fas fa-play mr-1"></i> Play';
                                isPlaying = false;
                                return;
                            });
                        } else {
                            playPauseBtn.innerHTML = '<i class="fas fa-pause mr-1"></i> Pause';
                        }
                    }
                }
                
                isPlaying = !isPlaying;
            };
            
            // Initialize video controls
            function initializeControls() {
                if (!video) return;
                
                // Use video's duration as reference
                const duration = video.duration || 0;
                
                // Update time display
                timeDisplay.textContent = `0:00 / ${formatTime(duration)}`;
                
                // Set up play/pause button
                playPauseBtn.removeEventListener('click', handlePlayPause);
                playPauseBtn.addEventListener('click', handlePlayPause);
                
                // Progress bar controls
                progressBar.addEventListener('input', function() {
                    // Pause if playing
                    if (isPlaying) {
                        video.pause();
                        playPauseBtn.innerHTML = '<i class="fas fa-play mr-1"></i> Play';
                        isPlaying = false;
                    }
                    
                    // Set video time
                    const newTime = (progressBar.value / 100) * duration;
                    video.currentTime = newTime;
                    
                    // Update time display
                    timeDisplay.textContent = `${formatTime(newTime)} / ${formatTime(duration)}`;
                });
                
                // Update progress bar as video plays
                video.addEventListener('timeupdate', function() {
                    if (video.duration) {
                        const progress = (video.currentTime / video.duration) * 100;
                        progressBar.value = progress;
                        timeDisplay.textContent = `${formatTime(video.currentTime)} / ${formatTime(video.duration)}`;
                    }
                });
                
                // Handle video ended
                video.addEventListener('ended', function() {
                    playPauseBtn.innerHTML = '<i class="fas fa-play mr-1"></i> Play';
                    isPlaying = false;
                    progressBar.value = 0;
                    timeDisplay.textContent = `0:00 / ${formatTime(duration)}`;
                });
                
                // Add click handler to video
                video.removeEventListener('click', handlePlayPause);
                video.addEventListener('click', handlePlayPause);
            };
            
            // Back to top button functionality
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.add('visible');
                } else {
                    backToTopBtn.classList.remove('visible');
                }
            });
            
            backToTopBtn.addEventListener('click', (e) => {
                e.preventDefault();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
            
            // Enable smooth scrolling for all anchor links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    if (this.getAttribute('href') !== '#') {
                        e.preventDefault();
                        const target = document.querySelector(this.getAttribute('href'));
                        if (target) {
                            target.scrollIntoView({ behavior: 'smooth' });
                        }
                    }
                });
            });
            
            // Initialize lazy loading for videos
            if ('IntersectionObserver' in window) {
                const videoObserver = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const video = entry.target;
                            const source = video.querySelector('source');
                            if (source.dataset.src) {
                                source.src = source.dataset.src;
                                video.load();
                                videoObserver.unobserve(video);
                            }
                        }
                    });
                }, { threshold: 0.1 });
                
                document.querySelectorAll('video[data-lazy="true"]').forEach(video => {
                    videoObserver.observe(video);
                });
            };

        });
    </script>
    <script src="js/teaser-examples.js"></script>
</body>
</html>
